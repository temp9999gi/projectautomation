import cog
import re


def cppunit_tests(test_class, header_file):
results = []
pattern = re.compile(".* %s::(test.*)\(\).*" % test_class)
for line in open(header_file.replace('.h', '.cpp')):
m = pattern.match(line, 1)
if m:
results.append(m.group(1))
return results


def cppunit_macros(test_class, header_file):
for test in cppunit_tests(test_class, header_file):
cog.outl("CPPUNIT_TEST(""%s);" % test)


def cppunit_defs(test_class, header_file):
for test in cppunit_tests(test_class, header_file):
cog.outl("void %s();" % test)


# Finally, create a setup.py file with the code

from distutils.core import setup
setup(name='dyno_cog',
version='1.0.0',
author='Atomic Object',
description='Utility stuff for code generation',
py_modules=['dyno_cog'],
)

